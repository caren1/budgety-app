<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
        <link href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css">
        <link type="text/css" rel="stylesheet" href="style.css">
        <title>Budgety</title>
    </head>
    <body>
        
        <div class="top">
            <div class="budget">
                <div class="budget__title">
                    Available Budget in <span class="budget__title--month">%Month%</span>:
                </div>
                
                <div class="budget__value">+ 2,345.64</div>
                
                <div class="budget__income clearfix">
                    <div class="budget__income--text">Income</div>
                    <div class="right">
                        <div class="budget__income--value">+ 4,300.00</div>
                        <div class="budget__income--percentage">&nbsp;</div>
                    </div>
                </div>
                
                <div class="budget__expenses clearfix">
                    <div class="budget__expenses--text">Expenses</div>
                    <div class="right clearfix">
                        <div class="budget__expenses--value">- 1,954.36</div>
                        <div class="budget__expenses--percentage">45%</div>
                    </div>
                </div>
            </div>
        </div>
        
        
        
        <div class="bottom">
            <div class="add">
                <div class="add__container">
                    <select class="add__type">
                        <option value="inc" selected>+</option>
                        <option value="exp">-</option>
                    </select>
                    <input type="text" class="add__description" placeholder="Add description">
                    <input type="number" class="add__value" placeholder="Value">
                    <button class="add__btn"><i class="ion-ios-checkmark-outline"></i></button>
                </div>
            </div>
            
            <div class="container clearfix">
                <div class="income">
                    <h2 class="icome__title">Income</h2>
                    
                    <div class="income__list">
                       
                        <!--
                        <div class="item clearfix" id="income-0">
                            <div class="item__description">Salary</div>
                            <div class="right clearfix">
                                <div class="item__value">+ 2,100.00</div>
                                <div class="item__delete">
                                    <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="item clearfix" id="income-1">
                            <div class="item__description">Sold car</div>
                            <div class="right clearfix">
                                <div class="item__value">+ 1,500.00</div>
                                <div class="item__delete">
                                    <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                </div>
                            </div>
                        </div>
                        -->
                        
                    </div>
                </div>
                
                
                
                <div class="expenses">
                    <h2 class="expenses__title">Expenses</h2>
                    
                    <div class="expenses__list">
                       
                        <!--
                        <div class="item clearfix" id="expense-0">
                            <div class="item__description">Apartment rent</div>
                            <div class="right clearfix">
                                <div class="item__value">- 900.00</div>
                                <div class="item__percentage">21%</div>
                                <div class="item__delete">
                                    <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="item clearfix" id="expense-1">
                            <div class="item__description">Grocery shopping</div>
                            <div class="right clearfix">
                                <div class="item__value">- 435.28</div>
                                <div class="item__percentage">10%</div>
                                <div class="item__delete">
                                    <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                </div>
                            </div>
                        </div>
                        -->
                        
                    </div>
                </div>
            </div>
            
            
        </div>
        <!-- FOR GITHUB PURPOSES JS PLACED IN SCRIPT TAG -->
        <!-- <script src="app.js"></script>  -->
        <script>
            var budgetController=(()=>{var e=function(e,t,n){this.id=e,this.descirption=t,this.value=n,this.percentage=-1};e.prototype.calcPercentage=function(e){this.percentage=e>0?Math.round(this.value/e*100):-1},e.prototype.getPercentage=function(){return this.percentage};var t=function(e,t,n){this.id=e,this.descirption=t,this.value=n},n=function(e){var t=0;a.allItems[e].forEach(e=>{t+=e.value}),a.totals[e]=t},a={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1};return{addItem:(n,i,l)=>{var r,c;return c=a.allItems[n].length>0?a.allItems[n][a.allItems[n].length-1].id+1:0,"exp"===n?r=new e(c,i,l):"inc"===n&&(r=new t(c,i,l)),a.allItems[n].push(r),r},deleteItem:(e,t)=>{var n;-1!==(n=a.allItems[e].map(function(e){return e.id}).indexOf(t))&&a.allItems[e].splice(n,1)},calculateBudget:function(){n("exp"),n("inc"),a.budget=a.totals.inc-a.totals.exp,a.totals.inc>0?a.percentage=Math.round(a.totals.exp/a.totals.inc*100):a.percentage=-1},calculatePercentages:function(){a.allItems.exp.forEach(function(e){e.calcPercentage(a.totals.inc)})},getPercentages:function(){return a.allItems.exp.map(function(e){return e.getPercentage()})},getBudget:function(){return{budget:a.budget,totalInc:a.totals.inc,totalExp:a.totals.exp,percentage:a.percentage}}}})(),UIController=(()=>{var e={inputType:".add__type",inputDescription:".add__description",inputValue:".add__value",inputBtn:".add__btn",incomeContainer:".income__list",expenseContainer:".expenses__list",budgetLabel:".budget__value",incomeLabel:".budget__income--value",expensesLabel:".budget__expenses--value",percentageLabel:".budget__expenses--percentage",container:".container",expensesPercLabel:".item__percentage",dateLabel:".budget__title--month"},t=function(e,t){var n,a;return(a=(n=(e=(e=Math.abs(e)).toFixed(2)).split("."))[0]).length>3&&(a=a.substr(0,a.length-3)+","+a.substr(a.length-3,3)),("exp"===t?"-":"+")+" "+a+"."+n[1]},n=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)};return{getinput:()=>({type:document.querySelector(e.inputType).value,description:document.querySelector(e.inputDescription).value,value:parseFloat(document.querySelector(e.inputValue).value)}),addListItem:(n,a)=>{var i,l,r;"inc"===a?(r=e.incomeContainer,i='<div class="item clearfix" id="inc-%id%"><div class="item__description">%description%</div><div class="right clearfix"><div class="item__value">%value%</div><div class="item__delete"><button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button></div></div></div>'):"exp"===a&&(r=e.expenseContainer,i='<div class="item clearfix" id="exp-%id%"><div class="item__description">%description%</div><div class="right clearfix"><div class="item__value">%value%</div><div class="item__percentage">21%</div><div class="item__delete"><button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button></div></div> </div>'),l=(l=(l=i.replace("%id%",n.id)).replace("%description%",n.descirption)).replace("%value%",t(n.value),a),document.querySelector(r).insertAdjacentHTML("beforeend",l)},deleteListItem:function(e){var t=document.getElementById(e);t.parentNode.removeChild(t)},clearFields:()=>{var t,n;t=document.querySelectorAll(e.inputDescription+","+e.inputValue),(n=Array.prototype.slice.call(t)).forEach(function(e,t,n){e.value=""}),n[0].focus()},displayBudget:n=>{var a;a=n.budget>0?"inc":"exp",document.querySelector(e.budgetLabel).textContent=t(n.budget,a),document.querySelector(e.incomeLabel).textContent=t(n.totalInc,"inc"),document.querySelector(e.expensesLabel).textContent=t(n.totalExp,"exp"),n.percentage>0?document.querySelector(e.percentageLabel).textContent=n.percentage+"%":document.querySelector(e.percentageLabel).textContent="---"},displayPercentages:function(t){var a=document.querySelectorAll(e.expensesPercLabel);n(a,function(e,n){t[n]>0?e.textContent=t[n]+"%":e.textContent="---"})},displayMonth:function(){var t,n,a,i;a=["January","February","March","April","May","June","July","August","September","October","November","December"],n=(t=new Date).getFullYear(),i=t.getMonth(),document.querySelector(e.dateLabel).textContent=a[i]+" "+n},changedType:function(){var t=document.querySelectorAll(e.inputType+","+e.inputDescription+","+e.inputValue);n(t,function(e){e.classList.toggle("red-focus")}),document.querySelector(e.inputBtn).classList.toggle("red")},getDOMstrings:()=>e}})(),controller=function(e,t){var n=()=>{e.calculateBudget();var n=e.getBudget();t.displayBudget(n)},a=function(){e.calculatePercentages();var n=e.getPercentages();t.displayPercentages(n)},i=()=>{var i,l;""!==(i=t.getinput()).description&&!isNaN(i.value)&&i.value>0&&(l=e.addItem(i.type,i.description,i.value),t.addListItem(l,i.type),t.clearFields(),n(),a())},l=function(i){var l,r,c,o;(l=i.target.parentNode.parentNode.parentNode.parentNode.id)&&(c=(r=l.split("-"))[0],o=parseInt(r[1]),e.deleteItem(c,o),t.deleteListItem(l),n(),a())};return{init:()=>{console.log("Application has started."),t.displayBudget({budget:0,totalInc:0,totalExp:0,percentage:-1}),(()=>{var e=t.getDOMstrings();document.querySelector(e.inputBtn).addEventListener("click",i),document.addEventListener("keypress",e=>{13!==e.keyCode&&13!==e.which||i()}),document.querySelector(e.container).addEventListener("click",l),document.querySelector(e.inputType).addEventListener("change",t.changedType)})(),t.displayMonth()}}}(budgetController,UIController);controller.init();
        </script>
    </body>
</html>